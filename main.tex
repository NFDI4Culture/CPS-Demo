\documentclass{book}

% load packages
\usepackage{geometry}
\usepackage{hyperref,bookmark}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{etoolbox}

%% Set page size
\geometry{a4paper, total={170mm,257mm}, left=25mm, top=20mm, bottom=20mm, right=25mm}

%% Set colours
\definecolor{light}{HTML}{E6E6FA}
\definecolor{highlight}{HTML}{800080}
\definecolor{dark}{HTML}{330033}

$if(graphics)$
% We will generate all images so they have a width \maxwidth. This means
% that they will get their normal width if they fit onto the page, but
% are scaled down if they would overflow the margins.
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
\else\Gin@nat@width\fi}
\makeatother
\let\Oldincludegraphics\includegraphics
\renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=\maxwidth]{#1}}
$endif$


\begin{document}

$title.tex()$ 

$before-body.tex()$

$toc.tex()$

$body$

\end{document}